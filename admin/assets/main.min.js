(c=>{var r="lwpscModal",n={type:"html",content:"",url:"",ajax:{},ajaxRequest:null,closeOnEsc:!0,closeOnOverlayClick:!0,clone:!1,overlay:{block:void 0,tpl:'<div class="'+r+'-overlay"></div>',css:{backgroundColor:"#000",opacity:.6,zIndex:1e5}},container:{block:void 0,tpl:'<div class="'+r+'-container"><div class="'+r+'-container_i"><div class="'+r+'-container_i2"></div></div></div>'},preloader:{verticalAlign:void 0,tpl:'<div class="'+r+'-preloader" />'},wrap:void 0,body:void 0,errors:{tpl:'<div class="'+r+"-error "+r+'-close"></div>',autocloseDelay:2e3,ajaxUnsuccessfulLoad:"Error"},openEffect:{type:"fade",speed:400},closeEffect:{type:"fade",speed:400},width:"auto",verticalAlign:"middle",beforeOpen:c.noop,afterOpen:c.noop,beforeClose:c.noop,afterClose:c.noop,afterLoading:c.noop,afterLoadingOnShow:c.noop,errorLoading:c.noop},l=0,s=c([]),d=function(e,n){var a=!0;return c(e).each(function(){c(n.target).get(0)==c(this).get(0)&&(a=!1),0==c(n.target).closest("HTML",c(this).get(0)).length&&(a=!1)}),a},o={getParentEl:function(e){var n=c(e);return n.data(r)?n:(n=c(e).closest("."+r+"-container").data(r+"ParentEl"))||!1},transition:function(e,n,a,t){switch(t=null==t?c.noop:t,a.type){case"fade":"show"==n?e.fadeIn(a.speed,t):e.fadeOut(a.speed,t);break;case"none":"show"==n?e.show():e.hide(),t()}},setWrapMarginRight:function(e,n){e.wrap.css("marginRight",n+"px"),c(document).trigger(r+"_setWrapMarginRight",n)},initEl:function(n,e){var a=n.data(r);if(!a){if(l++,(a=e).modalID=l,a.overlay.block=c(a.overlay.tpl),a.overlay.block.css(a.overlay.css),a.container.block=c(a.container.tpl),a.body=c("."+r+"-container_i2",a.container.block),e.clone?a.body.html(n.clone(!0)):(n.before('<div id="'+r+"Reserve"+a.modalID+'" style="display: none" />'),a.body.html(n)),a.body.on("click","."+r+"-close",function(){return n[r]("close"),!1}),a.closeOnOverlayClick&&a.overlay.block.add(a.container.block).click(function(e){d(c(">*",a.body),e)&&n[r]("close")}),a.container.block.data(r+"ParentEl",n),n.data(r,a),s=c.merge(s,n),c.proxy(p.show,n)(),"html"==a.type)return n;null!=a.ajax.beforeSend&&(t=a.ajax.beforeSend,delete a.ajax.beforeSend),null!=a.ajax.success&&(o=a.ajax.success,delete a.ajax.success),null!=a.ajax.error&&(i=a.ajax.error,delete a.ajax.error);var t,o,i,e=c.extend(!0,{url:a.url,beforeSend:function(){a.body.html(a.preloader.tpl).css("verticalAlign",(void 0===a.preloader.verticalAlign?a:a.preloader).verticalAlign),void 0!==t&&t(a,n)},success:function(e){n.trigger("afterLoading."+r),e=a.afterLoading(a,n,e)||e,a.body.css("verticalAlign",a.verticalAlign),null==o?a.body.html(e):o(a,n,e),n.trigger("afterLoadingOnShow."+r),a.afterLoadingOnShow(a,n,e)},error:function(){n.trigger("errorLoading."+r),a.errorLoading(a,n),null==i?(a.body.html(a.errors.tpl),c("."+r+"-error",a.body).html(a.errors.ajaxUnsuccessfulLoad),c("."+r+"-close",a.body).click(function(){return n[r]("close"),!1}),a.errors.autocloseDelay&&setTimeout(function(){n[r]("close")},a.errors.autocloseDelay)):i(a,n)}},a.ajax);a.ajaxRequest=c.ajax(e),n.data(r,a)}},init:function(e){return e=c.extend(!0,{},n,e),c.isFunction(this)?null!=e?""!=e.url?(e.type="ajax",o.initEl(c("<div />"),e)):""!=e.content?(e.type="html",o.initEl(c(e.content),e)):void c.error(r+': Set parameter "url" or "content"'):void c.error(r+": Uncorrect parameters"):this.each(function(){o.initEl(c(this),c.extend(!0,{},e))})}},p={show:function(){var e,n,a,t=o.getParentEl(this);if(!1!==t)return(e=t.data(r)).overlay.block.hide(),e.container.block.hide(),c("BODY").append(e.overlay.block),c("BODY").append(e.container.block),e.container.block.css("zIndex",e.overlay.block.css("zIndex")),e.beforeOpen(e,t),t.trigger("beforeOpen."+r),"hidden"!=e.wrap.css("overflow-y")&&(e.wrap.data(r+"Overflow",e.wrap.css("overflow-y")),n=e.wrap.outerWidth(!0),e.wrap.css("overflow-y","hidden"),(a=e.wrap.outerWidth(!0))!=n)&&o.setWrapMarginRight(e,a-n),s.not(t).each(function(){c(this).data(r).overlay.block.hide()}),e.body.css("verticalAlign",e.verticalAlign),e.body.parent().css("width",e.width),o.transition(e.overlay.block,"show",1<s.length?{type:"none"}:e.openEffect),o.transition(e.container.block,"show",1<s.length?{type:"none"}:e.openEffect,function(){e.afterOpen(e,t),t.trigger("afterOpen."+r)}),t;c.error(r+": Uncorrect call")},close:function(){if(!c.isFunction(this))return this.each(function(){var e,n=o.getParentEl(this);!1===n?c.error(r+": Uncorrect call"):!1!==(e=n.data(r)).beforeClose(e,n)&&(n.trigger("beforeClose."+r),s.not(n).last().each(function(){c(this).data(r).overlay.block.show()}),o.transition(e.overlay.block,"hide",1<s.length?{type:"none"}:e.closeEffect),o.transition(e.container.block,"hide",1<s.length?{type:"none"}:e.closeEffect,function(){e.afterClose(e,n),n.trigger("afterClose."+r),e.clone||c("#"+r+"Reserve"+e.modalID).replaceWith(e.body.find(">*")),e.overlay.block.remove(),e.container.block.remove(),n.data(r,null),c("."+r+"-container").length||(e.wrap.data(r+"Overflow")&&e.wrap.css("overflow-y",e.wrap.data(r+"Overflow")),o.setWrapMarginRight(e,0))}),"ajax"==e.type&&e.ajaxRequest.abort(),s=s.not(n))});s.each(function(){c(this)[r]("close")})},getActive:function(){var e=c("."+r+"-container").last();return!!e.length&&e.data(r+"ParentEl").data(r)},setDefault:function(e){c.extend(!0,n,e)}};c(function(){n.wrap=c(document.all&&!document.querySelector?"html":"body")}),c(document).bind("keyup."+r,function(e){var n=s.last();n.length&&n.data(r).closeOnEsc&&27===e.keyCode&&n[r]("close")}),c[r]=c.fn[r]=function(e){return p[e]?p[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void c.error(r+": Method "+e+" does not exist"):o.init.apply(this,arguments)}})(jQuery),(t=>{var o="lwpscAjaxForm",n={afterInit:t.noop,beforeSend:t.noop,success:t.noop,error:function(){alert("Failed to execute the query. Reload the page and try again.")},b:{}},i={isForm:function(e){return"form"==e.get(0).tagName.toLowerCase()},makeData:function(e){var n;return(i.isForm(e)?e:(n=e.clone().wrap("<form/>"),e.find("select").each(function(e){n.find("select").eq(e).val(t(this).val())}),n)).serialize()},submit:function(e,n){t.ajax({type:"POST",cache:!1,data:i.makeData(e),url:i.isForm(e)?e.attr("action"):e.data("action"),beforeSend:function(){n.beforeSend(n,e)},success:function(e){n.b.container.html(e),n.success(n)},error:function(){n.error(n,e)}})},initContainer:function(e,n){var a=e.data(o);a||(a=n,e.data(o,a),(a.b.container=e).on("submit","[data-ajax-form]",function(){return i.submit(t(this),a),!1}),a.afterInit(a))},init:function(e){return e=t.extend(!0,{},n,e),t.isFunction(this)?(t.error(o+": Uncorrect call"),!1):this.each(function(){i.initContainer(t(this),t.extend(!0,{},e))})}},a={setDefault:function(e){t.extend(!0,n,e)}};t[o]=t.fn[o]=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error(o+": Method "+e+" does not exist"),!1):i.init.apply(this,arguments)}})(jQuery),(n=>{var a="lwpscPreloader";n.fn[a+"Show"]=function(){var e=n(this);e.addClass(a+"Wrapper"),e.append('<div class="'+a+'Overlay"><div class="lwpscDarkSpinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>')},n.fn[a+"Hide"]=function(){var e=n(this);e.removeClass(a+"Wrapper"),e.find("."+a+"Overlay").remove()}})(jQuery),(o=>{o(function(){var e=o(".lwpscManage"),t=e.find(".lwpscManage_area"),a=t.find(".lwpscManage_items");a.sortable({handle:".lwpscManage_item_sortHandle",axis:"y",revert:200,connectWith:".lwpscManage_items",stop:function(){var n=[];t.each(function(){var e=o(this).data("id");o(this).find(".lwpscManage_item").each(function(){n.push(o(this).data("id")+","+e)})}),o.ajax({url:lwpscMain.ajaxUrl,method:"POST",data:{action:"lwpsc_sort",nonce:lwpscMain.nonce,data:n}})}}),e.find(".lwpscManage_add .button").click(function(){o.lwpscModal({url:lwpscMain.ajaxUrl,closeOnOverlayClick:!1,ajax:{data:{action:"lwpsc_add_item",nonce:lwpscMain.nonce,areaId:o(this).closest(".lwpscManage_area").data("id")}},afterLoadingOnShow:function(e){e.body.lwpscAjaxForm({afterInit:function(e){e.b.container.find('INPUT[type="text"]').focus()},beforeSend:function(e){e.b.container.find(".lwpscModalBox").lwpscPreloaderShow()},success:function(e){e.b.container.find(".lwpscModalBox").length||e.b.container.lwpscModal("close")}})}})}),o(document).on("lwpscItemCreated",function(e,n){var a=t.filter('[data-id="'+n.areaId+'"]').find(".lwpscManage_items");a.length&&a.append(n.html)}),a.on("click",".lwpscManage_item_edit",function(){o.lwpscModal({url:lwpscMain.ajaxUrl,closeOnOverlayClick:!1,ajax:{data:{action:"lwpsc_edit_item",nonce:lwpscMain.nonce,id:o(this).closest(".lwpscManage_item").data("id")}},afterLoadingOnShow:function(e){e.body.lwpscAjaxForm({afterInit:function(e){e.b.container.find('INPUT[type="text"]').focus()},beforeSend:function(e){e.b.container.find(".lwpscModalBox").lwpscPreloaderShow()},success:function(e){e.b.container.find(".lwpscModalBox").length||e.b.container.lwpscModal("close")}})}})}),o(document).on("lwpscItemUpdated",function(e,n){a.find('.lwpscManage_item[data-id="'+n.id+'"]').replaceWith(n.html)}),a.on("click",".lwpscManage_item_disable,.lwpscManage_item_enable",function(){var n=o(this).closest(".lwpscManage_item"),a=n.closest(".lwpscManage_area");o.ajax({url:lwpscMain.ajaxUrl,data:{action:"lwpsc_"+(o(this).hasClass("lwpscManage_item_disable")?"disable":"enable")+"_item",nonce:lwpscMain.nonce,id:n.data("id")},beforeSend:function(){a.lwpscPreloaderShow()},success:function(e){n.replaceWith(e),a.lwpscPreloaderHide()}})}),a.on("click",".lwpscManage_item_delete",function(){o.lwpscModal({url:lwpscMain.ajaxUrl,closeOnOverlayClick:!1,ajax:{data:{action:"lwpsc_delete_item",nonce:lwpscMain.nonce,id:o(this).closest(".lwpscManage_item").data("id")}},afterLoadingOnShow:function(e){e.body.lwpscAjaxForm({beforeSend:function(e){e.b.container.find(".lwpscModalBox").lwpscPreloaderShow()},success:function(e){e.b.container.find(".lwpscModalBox").length||e.b.container.lwpscModal("close")}})}})}),a.on("click",".lwpscManage_deletedItem_hide",function(){o(this).closest(".lwpscManage_deletedItem").animate({opacity:0,height:0,paddingTop:0,paddingBottom:0},{complete:function(){o(this).remove()}})}),o(document).on("lwpscItemDeleted",function(e,n){a.find('.lwpscManage_item[data-id="'+n.id+'"]').replaceWith(n.html)})}),o(function(){var e=o(".lwpscRate");e.length&&e.on("click",".button",function(){o.ajax({url:lwpscMain.ajaxUrl,method:"POST",data:{action:o(this).data("action")},beforeSend:function(){e.lwpscPreloaderShow()},success:function(){e.remove()}})})})})(jQuery),(n=>{n(function(){var e=n(".lwpscWelcome");e.length&&e.find(".lwpscWelcome_hide").click(function(){n.ajax({url:lwpscMain.ajaxUrl,method:"POST",data:{action:"lwpsc_welcome_hide"},beforeSend:function(){e.lwpscPreloaderShow()},success:function(){e.remove()}})})})})(jQuery);